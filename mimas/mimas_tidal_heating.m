function [tidal_heating,total_heating] = mimas_tidal_heating(thickness,eccentricity,core_type)
% core_type = [1,2] == [rigid,fluffy]
% thickness should be in km
% eccentricity is unitless
% returns tidal heating and the total heating in W/m^2

reference_eccentricity = 0.0196;
eccentricity_factor = eccentricity^2/reference_eccentricity^2;
%Shell thickness	Total GW (tidal)	Tidal heat flow at shell base	Basal heat flow (core, tidal)	Basal heat flow (core, radiogenic)	Heat flow input for Max
if core_type == 1 % rigid
    data = [1	180.302	368.958	0.15123506	0.12277998;
        2	104.178	215.362	0.15278063	0.12403475;
        3	72.8424	152.130	0.15435001	0.12530885;
        4	55.8507	117.847	0.15594370	0.12660269;
        5	45.2028	96.370	0.15756220	0.12791667;
        6	37.9096	81.664	0.15920604	0.12925121;
        7	32.6034	70.970	0.16087573	0.13060675;
        8	28.5709	62.848	0.16257182	0.13198372;
        9	25.4034	56.473	0.16429488	0.13338258;
        10	22.8502	51.338	0.16604548	0.13480380;
        15	15.09737	35.796	0.17523278	0.14226250;
        20	11.1677	27.986	0.18520423	0.15035781;
        25	8.79833	23.340	0.19605166	0.15916428;
        30	7.2093	20.278	0.20788077	0.16876773;
        35	6.06329	18.116	0.22081368	0.17926730;
        40	5.19043	16.504	0.23499214	0.19077806;
        45	4.49649	15.246	0.25058136	0.20343415;
        50	3.92562	14.223	0.26777491	0.21739271;
        55	3.4432	13.362	0.28680073	0.23283880;
        60	3.0271	12.612	0.30792873	0.24999153;
        65	2.66282	11.943	0.33148039	0.26911192;
        70	2.34064	11.333	0.35784112	0.29051284];
elseif core_type == 2 % fluffy
    % last column includes a fudge factor...
    data=[1	230.442	471.561	3.02470113	0.12277998	522.1794135;
        2	133.506	275.990	3.05561254	0.12403475	307.0863097;
        3	93.4426	195.153	3.08700023	0.12530885	218.2019346;
        4	71.683	151.254	3.11887406	0.12660269	169.9498033;
        5	58.0352	123.728	3.15124410	0.12791667	139.7076839;
        6	48.6816	104.869	3.18412070	0.12925121	119.0008976;
        7	41.8736	91.150	3.21751450	0.13060675	103.9474687;
        8	36.698	80.726	3.25143640	0.13198372	92.51996824;
        9	32.6315	72.541	3.28589760	0.13338258	83.55656019;
        10	29.3528	65.948	3.32090958	0.13480380	76.34388494;
        15	19.3873	45.968	3.50465563	0.14226250	54.57651698;
        20	14.3393	35.934	3.70408454	0.15035781	43.76702482;
        25	11.2912	29.953	3.92103315	0.15916428	37.43607216;
        30	9.24658	26.009	4.15761534	0.16876773	33.36863349;
        35	7.77237	23.222	4.41627369	0.17926730	30.59951114;
        40	6.65039	21.146	4.69984279	0.19077806	28.64007214;
        45	5.75945	19.528	5.01162721	0.20343415	27.2171623;
        50	5.02763	18.216	5.35549825	0.21739271	26.16796554;
        55	4.4102	17.114	5.73601467	0.23283880	25.39160945;
        60	3.87849	16.160	6.15857455	0.24999153	24.82523316;
        65	3.41362	15.311	6.62960784	0.26911192	24.43043207;
        70	3.00289	14.540	7.15682238	0.29051284	24.18566743];
end
data(:,1) = data(:,1)*1000; % km -> m.
data(:,3:4) = eccentricity_factor*data(:,3:4); % scale the tidal dissipation by the eccentricity

all_total_heating = sum(data(:,3:5),2)/1000;
all_tidal_heating = sum(data(:,3:4),2)/1000;
thicknesses = data(:,1);

tidal_heating = interp1(thicknesses,all_tidal_heating,thickness);
total_heating = interp1(thicknesses,all_total_heating,thickness);
